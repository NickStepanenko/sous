<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <link href="bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="bower_components/bootstrap/dist/css/shop-item.css" rel="stylesheet">

    <script type="text/javascript" src="bower_components/jquery/dist/jquery.js"></script>
    <script type="text/javascript" src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>

    <script type="text/javascript" language="javascript" src="patches.json"></script>
    <script>
        var currentState = 1;

        function applyCommitForward() {
            $("#commitsWindow").append("\<li id=\"comment" + (currentState + 1) + "\" class=\"list-group-item list-group-item-info\"\>" +
                    data.commits[currentState+1].comment
                    + "\</li\>"
            );

            currentState++;

            if(currentState == data.commits.length - 1) {
                $("#commitsSwitcher-next").prop('disabled', true);
            }

            $("#commitsSwitcher-prev").prop('disabled', false);
        }

        function applyCommitBack() {
            $("li[id=comment" + currentState + "]").remove();

            currentState--;

            if(currentState == 1) {
                $("#commitsSwitcher-prev").prop('disabled', true);
            }

            $("#commitsSwitcher-next").prop('disabled', false);
        }

        function changeState(n_state) {
            if(n_state > currentState) {
                while(n_state > currentState) applyCommitForward();
            } else {
                while(n_state < currentState) applyCommitBack();
            }
        }

        var data = JSON.parse(JSON.stringify(jsonObject));
        console.log(data);

        (function ($) {$(document).ready(function() {
            $("#header-name").append(data.commits[0].comment);

            for(i=1; i<data.commits.length; i++) {
                $("#listOfSlides").append("\<li\>\<a href=\"#\"\>Слайд " + i + "\</a\>\</li\>");
            }

            var files = data.commits[1].content;

            for(i=0; i<files.length; i++) {
                if(i==0) {
                    $("#filesSwitcher").append(
                            "\<li class=\"active\"\>\<a data-toggle=\"tab\" href=\"#file" + i + "\"\>" +
                            files[i].filename
                            + "\</a\>\</li\>"
                    );
                } else {
                    $("#filesSwitcher").append(
                            "\<li\>\<a data-toggle=\"tab\" href=\"#file" + i + "\"\>" +
                            files[i].filename
                            + "\</a\>\</li\>"
                    );
                }

                var code = "";

                for(j=0; j<files[i].changes.length; j++) {
                    code += files[i].changes[j].changesCode;
                }

                $("#filesContent").append(
                        "\<div id=\"file" + i + "\" class=\"tab-pane fade in active\"\> " +
                        "\<pre\>" +
                        code +
                        "\</pre\> " +
                        "\</div\>"
                );
            }

            $("#commitsWindow").append("\<li id=\"comment1\" class=\"list-group-item list-group-item-info\"\>" +
                    data.commits[1].comment
                    + "\</li\>"
            );

            if(currentState == 1) {
                $("#commitsSwitcher-prev").prop('disabled', true);
            }

            $('#commitsSwitcher-prev').on('click', function() {
                if(currentState > 0) {
                    changeState(currentState - 1);
                }
            });

            $("#commitsSwitcher-next").on('click', function() {
                if(!$("#commitsSwitcher-next").prop('disabled')) {
                    changeState(currentState + 1);
                }
            });

            $("")
        });})(jQuery);
    </script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                </button>
                <a id="header-name" class="navbar-brand" href="#"></a>
            </div>
        </div>
        <!-- /.container -->
    </nav>

    <div id="content" class="container">
        <div class="row">
            <div class="col-md-4">
                <div id="commitsSwitcher" style="padding-bottom: 10px">
                    <div class="btn-group" role="group" aria-label="..." align="left" style="position: relative">
                        <button id="commitsSwitcher-prev" type="button" class="btn btn-primary"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span></button>
                        <div class="btn-group">
                            <button type="button" class="btn btn-default">Слайды</button>
                            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                                <span class="caret"></span>
                                <span class="sr-only">Toggle Dropdown</span>
                            </button>
                            <ul id="listOfSlides" class="dropdown-menu" role="menu"></ul>
                        </div>
                        <button id="commitsSwitcher-next" type="button" class="btn btn-primary"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span></button>
                    </div>
                </div>
                <ul id="commitsWindow" class="list-group"></ul>
            </div>

            <div class="col-md-8">
                <div class="container">
                    <ul id="filesSwitcher" class="nav nav-tabs"></ul>
                    <div id="filesContent" class="tab-content"><!--class="tab-content"--></div>
                </div>
            </div>
        </div>
    </div>


    <div class="navbar-fixed-bottom row-fluid">
        <div class="navbar-inner">
            <div class="progress-bar progress-bar-striped" role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100"
                 style="width: 85%; padding: 5px;">
                <span class="sr-only">45% Complete</span>
            </div>
        </div>
    </div>
</body>
</html>